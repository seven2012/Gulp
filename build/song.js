"use strict";$(function(){function n(n){$('<img class="picture" src='+n+' alt="picture">').appendTo(".disc-container")}function a(n){console.log(n);$("#disc-wrapper");$backgroundImg=$("#disc-wrapper").css("background","transparent url("+n+") no-repeat center").css("background-size","cover")}function e(n,a){$(".m-song-info > h2").text(n),i(a)}function t(n){var a=document.createElement("audio");a.src=n,a.oncanplay=function(){a.play(),$(".disc-container").addClass("playing"),$(".pointer").addClass("change2"),$(".pointer").removeClass("change1"),$(".disc-container").css("animation-play-state","running")},a.addEventListener("ended",function(){a.play()}),$(".icon-pause").on("click",function(){a.pause(),$(".disc-container").removeClass("playing"),$(".pointer").addClass("change1"),$(".pointer").removeClass("change2"),$(".disc-container").css("animation-play-state","paused")}),$(".icon-play").on("click",function(){a.play(),$(".disc-container").addClass("playing"),$(".pointer").addClass("change2"),$(".pointer").removeClass("change1"),$(".disc-container").css("animation-play-state","running")}),setInterval(function(){for(var n=a.currentTime,e=~~(n/60),t=n-60*e,i=c(e)+":"+c(t),r=$(".lyric-scroll> p"),o=void 0,s=0;s<r.length;s++){var l=r.eq(s).attr("data-time"),d=r.eq(s+1).attr("data-time");if(0!==r.eq(s+1).length&&l<i&&d>i){o=r.eq(s);break}}if(o){o.addClass("active").prev().removeClass("active");var p=o.offset().top-$(".lyric-scroll").offset().top-$(".lyric").height()/3;$(".lyric-scroll").css("transform","translateY(-"+p+"px)")}},300)}function i(n){var a=n.split("\n"),e=/^\[(.+)\](.*)$/;a=a.map(function(n){var a=e.exec(n);if(a)return console.log(a[1]),console.log(a[2]),{time:a[1],words:a[2]}});var t=$(".lyric");a.map(function(n){if(n){var a=$("<p/>");a.attr("data-time",n.time).text(n.words),a.appendTo(t.children(".lyric-scroll"))}})}function c(n){return n>=10?n+"":"0"+n}var r=parseInt(location.search.match(/\bid=([^&]*)/)[1],10);$.get("./songs.json").then(function(i){var c=i.filter(function(n){return n.id===r})[0],o=c.url,s=c.name,l=c.img,d=c.back,p=c.lyric;t(o),e(s,p),n(l),a(d)})});